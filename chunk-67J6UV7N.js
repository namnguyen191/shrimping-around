import{a as P,h as x}from"./chunk-LHM5HC6X.js";import{b as W}from"./chunk-DUA4T6JW.js";import{$c as J,C as D,N as C,O as f,Oc as s,Qc as N,R as E,Tc as _,U as w,Uc as A,Vc as q,Wc as G,X as n,Xc as Z,Yc as B,Zc as $,_c as z,ad as V,ba as j,bd as T,d as p,e as I,ha as U,p as k,qa as F,r as m,v as M,va as H,wb as L,y as g,z as O}from"./chunk-I5YX4L7R.js";function R(e){e||(U(R),e=n(F));let r=new I(t=>e.onDestroy(t.next.bind(t)));return t=>t.pipe(C(r))}var ee=(()=>{class e{constructor(){this.#e=n(P),this.#t=t=>{let{endpoint:o,method:a,headers:v,body:u}=t;return this.#e.request(a,o,{headers:v,body:u})},this.httpFetcher=this.#t.bind(this)}#e;#t;static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275prov=E({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),te=s.strictObject({remoteResourceId:s.string()},{errorMap:()=>({message:'Invalid triggerRemoteResource action hook payload, example: { "type": "triggerRemoteResource", "payload": { "remoteResourceId": "123" }  } '})}),oe=s.strictObject({scope:B,data:W},{errorMap:()=>({message:'Invalid addToState action hook payload, example: { "type": "addToState", "payload": { "scope": "global", data: "{ "some": "data" }" }  } '})}),ne=s.strictObject({navigationType:s.union([s.literal("internal"),s.literal("external")]),url:s.string()},{errorMap:()=>({message:'Invalid navigate action hook payload, example: { "type": "navigate", "payload": { "navigationType": "internal", url: "/my/route" }  } '})}),re=(()=>{class e{constructor(){this.#e=n(J),this.#t=n($),this.#o=n(x),this.handleTriggerRemoteResource=({remoteResourceId:t})=>{this.#e.triggerResource(t)},this.handleAddToState=t=>{this.#t.addToState(t)},this.navigate=({navigationType:t,url:o})=>{t==="internal"?this.#o.navigateByUrl(o):window.open(o,"_blank")?.focus()}}#e;#t;#o;static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275prov=E({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),ie=()=>p(g(e=>e.type==="MISSING_LAYOUT_TEMPLATE")),se=()=>p(g(e=>e.type==="MISSING_REMOTE_RESOURCE_TEMPLATE")),ae=()=>p(g(e=>e.type==="MISSING_UI_ELEMENT_TEMPLATE")),ce=()=>p(g(e=>e.type==="UI_ELEMENT_REPOSITION")),ue=new w("COMMON_SETUP_CONFIG"),le=()=>{let e=n(re),r=n(G),t={addToState:{handler:e.handleAddToState,payloadParser:oe},triggerRemoteResource:{handler:e.handleTriggerRemoteResource,payloadParser:te},navigate:{handler:e.navigate,payloadParser:ne}};r.registerHooks(t)},de=()=>{let e=n(ee).httpFetcher;n(Z).registerFetcher("httpFetcher",e)},pe=e=>{let{getLayoutTemplate:r,getUiElementTemplate:t,getRemoteResourceTemplate:o,updateElementsPositionsHandler:a}=e,v=n(_),u=n(q),Y=n(V),K=n(z),y=v.getEvents().pipe(R());if(r&&y.pipe(ie(),m(i=>{let c=i.payload.id;return u.startRegisteringLayoutTemplate(c),r(c)}),f(i=>u.registerLayoutTemplate(i))).subscribe(),t&&y.pipe(ae(),m(i=>{let c=i.payload.id;return t(c)}),f(i=>{Y.registerUIElementTemplate(i)})).subscribe(),o&&y.pipe(se(),m(i=>{let c=i.payload.id;return o(c)}),f(i=>K.registerRemoteResourceTemplate(i))).subscribe(),a){let l=y.pipe(ce()),i=l.pipe(D(3e3));l.pipe(O(i),k(h=>h.reduce((d,b)=>{let{payload:{elementId:S,layoutId:Q,newPositionAndSize:X}}=b;return d=N(d,`${Q}.${S}`,X),d},{})),m(h=>{let d=Object.entries(h).map(([b,S])=>a(b,S));return M(d)})).subscribe()}},me=e=>{let r=n(T);for(let[t,o]of Object.entries(e))r.registerUIElement({type:t,component:o})},ge=e=>{let r=n(T);for(let[t,o]of Object.entries(e))r.registerUIElementLoader({type:t,loader:o})},Ae=()=>{let e;try{e=n(ue)}catch{A("No configs was provided for DJ-UI default setup, please provide values for the COMMON_SETUP_CONFIG token");return}le(),de();let{templatesHandlers:r,componentsMap:t,componentLoadersMap:o}=e;r&&pe(r),t&&me(t),o&&ge(o)},qe=(()=>{class e{constructor(){this.onHostClicked=H()}onClick(){this.onHostClicked.emit()}static{this.\u0275fac=function(o){return new(o||e)}}static{this.\u0275dir=j({type:e,selectors:[["","djuiCommonEmitOnClick",""]],hostBindings:function(o,a){o&1&&L("click",function(u){return a.onClick(u)})},outputs:{onHostClicked:"onHostClicked"},standalone:!0})}}return e})();export{R as a,ce as b,ue as c,Ae as d,qe as e};
