import{a as _,h as G}from"./chunk-PHLTZM6S.js";import{b as ee}from"./chunk-UF7MBORE.js";import{$c as $,B as j,Ba as q,Cb as A,E as S,F as U,I as F,T as L,U as T,Vc as u,X as M,Xc as Z,_ as P,_c as B,ad as z,ba as r,bd as J,cd as V,dd as W,e as m,ed as Y,f as g,fd as K,g as y,gd as Q,ha as H,hd as X,id as O,j as h,k as C,na as x,v as w,wa as N,x as b}from"./chunk-RS64QZAP.js";function D(e){e||(x(D),e=r(N));let t=new C(o=>e.onDestroy(o.next.bind(o)));return o=>o.pipe(L(t))}var ne=(()=>{var t,o;let n=class n{constructor(){g(this,t);g(this,o);y(this,t,r(_)),y(this,o,d=>{let{endpoint:s,method:c,headers:E,body:p}=d;return m(this,t).request(c,s,{headers:E,body:p})}),this.httpFetcher=m(this,o).bind(this)}};t=new WeakMap,o=new WeakMap,n.\u0275fac=function(s){return new(s||n)},n.\u0275prov=M({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})(),re=u.strictObject({remoteResourceId:u.string()},{errorMap:()=>({message:'Invalid triggerRemoteResource action hook payload, example: { "type": "triggerRemoteResource", "payload": { "remoteResourceId": "123" }  } '})}),ie=u.strictObject({scope:W,data:ee},{errorMap:()=>({message:'Invalid addToState action hook payload, example: { "type": "addToState", "payload": { "scope": "global", data: "{ "some": "data" }" }  } '})}),se=u.strictObject({navigationType:u.union([u.literal("internal"),u.literal("external")]),url:u.string()},{errorMap:()=>({message:'Invalid navigate action hook payload, example: { "type": "navigate", "payload": { "navigationType": "internal", url: "/my/route" }  } '})}),ae=(()=>{var t,o,n;let i=class i{constructor(){g(this,t);g(this,o);g(this,n);y(this,t,r(Q)),y(this,o,r(Y)),y(this,n,r(G)),this.handleTriggerRemoteResource=({remoteResourceId:s})=>{m(this,t).triggerResource(s)},this.handleAddToState=s=>{m(this,o).addToState(s)},this.navigate=({navigationType:s,url:c})=>{s==="internal"?m(this,n).navigateByUrl(c):window.open(c,"_blank")?.focus()}}};t=new WeakMap,o=new WeakMap,n=new WeakMap,i.\u0275fac=function(c){return new(c||i)},i.\u0275prov=M({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})(),ce=()=>h(S(e=>e.type==="MISSING_LAYOUT_TEMPLATE")),ue=()=>h(S(e=>e.type==="MISSING_REMOTE_RESOURCE_TEMPLATE")),le=()=>h(S(e=>e.type==="MISSING_UI_ELEMENT_TEMPLATE")),de=()=>h(S(e=>e.type==="UI_ELEMENT_REPOSITION")),pe=new P("COMMON_SETUP_CONFIG"),me=()=>{let e=r(ae),t=r(J),o={addToState:{handler:e.handleAddToState,payloadParser:ie},triggerRemoteResource:{handler:e.handleTriggerRemoteResource,payloadParser:re},navigate:{handler:e.navigate,payloadParser:se}};t.registerHooks(o)},ge=()=>{let e=r(ne).httpFetcher;r(V).registerFetcher("httpFetcher",e)},ye=e=>{let{getLayoutTemplate:t,getUiElementTemplate:o,getRemoteResourceTemplate:n,updateElementsPositionsHandler:i}=e,d=r(B),s=r(z),c=r(X),E=r(K),p=d.getEvents().pipe(D());if(t&&p.pipe(ce(),b(a=>{let l=a.payload.id;return s.startRegisteringLayoutTemplate(l),t(l)}),T(a=>s.registerLayoutTemplate(a))).subscribe(),o&&p.pipe(le(),b(a=>{let l=a.payload.id;return o(l)}),T(a=>{c.registerUIElementTemplate(a)})).subscribe(),n&&p.pipe(ue(),b(a=>{let l=a.payload.id;return n(l)}),T(a=>E.registerRemoteResourceTemplate(a))).subscribe(),i){let v=p.pipe(de()),a=v.pipe(F(3e3));v.pipe(U(a),w(R=>R.reduce((f,I)=>{let{payload:{elementId:k,layoutId:te,newPositionAndSize:oe}}=I;return f=Z(f,`${te}.${k}`,oe),f},{})),b(R=>{let f=Object.entries(R).map(([I,k])=>i(I,k));return j(f)})).subscribe()}},ve=e=>{let t=r(O);for(let[o,n]of Object.entries(e))t.registerUIElement({type:o,component:n})},fe=e=>{let t=r(O);for(let[o,n]of Object.entries(e))t.registerUIElementLoader({type:o,loader:n})},Ze=()=>{let e;try{e=r(pe)}catch{$("No configs was provided for DJ-UI default setup, please provide values for the COMMON_SETUP_CONFIG token");return}me(),ge();let{templatesHandlers:t,componentsMap:o,componentLoadersMap:n}=e;t&&ye(t),o&&ve(o),n&&fe(n)},Be=(()=>{let t=class t{constructor(){this.onHostClicked=q()}onClick(){this.onHostClicked.emit()}};t.\u0275fac=function(i){return new(i||t)},t.\u0275dir=H({type:t,selectors:[["","djuiCommonEmitOnClick",""]],hostBindings:function(i,d){i&1&&A("click",function(c){return d.onClick(c)})},outputs:{onHostClicked:"onHostClicked"},standalone:!0});let e=t;return e})();export{D as a,de as b,pe as c,Ze as d,Be as e};
